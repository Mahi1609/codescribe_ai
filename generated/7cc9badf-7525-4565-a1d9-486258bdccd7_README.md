# üëã Welcome to 7cc9badf-7525-4565-a1d9-486258bdccd7

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The primary entry point, `main.py`, orchestrates the extraction process by:
* Extracting text from PDF files using the `ocr_handler` module
* Preprocessing the extracted text with the `text_cleaner` utility
* Sending the cleaned text to the Ollama model for invoice field generation
* Saving the structured output to a JSON file

Key functions and classes include:
* `extract_text_from_pdf` (OCR extraction)
* `clean_ocr_text` (text preprocessing)
* `generate_invoice_fields` (Ollama model interaction)
The project relies on standard Python libraries, with no external dependencies detected.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

#### main.py
**Purpose:** Extract invoice fields from a PDF file using OCR and a local Ollama LLM.
**Key Functions:**
* `main(pdf_path)`: The main entry point of the script, responsible for orchestrating the invoice extraction process.
* `extract_text_from_pdf(pdf_path)`: Extracts text from a PDF file using OCR (imported from `ocr.ocr_handler`).
* `generate_invoice_fields(cleaned_text)`: Sends the preprocessed text to the local Ollama model to extract structured invoice fields (imported from `llm.ollama_parser`).
* `clean_ocr_text(text)`: Preprocesses the extracted text before sending it to the LLM (imported from `utils.text_cleaner`).
**Inputs:**
* `pdf_path`: The path to the PDF file to extract invoice fields from.
**Outputs:**
* A JSON file containing the extracted invoice fields, saved to the `output` directory.
**Side-Effects:**
* Creates the `output` directory if it does not exist.
* Prints various messages to the console to indicate the progress of the extraction process.
**Important Dependencies:**
* `ocr.ocr_handler` for OCR text extraction
* `llm.ollama_parser` for invoice field extraction using the local Ollama LLM
* `utils.text_cleaner` for text preprocessing

Some key points about the code:
* The script uses a command-line argument to specify the path to the PDF file.
* The script normalizes the PDF path for cross-platform compatibility.
* The script combines text from multiple pages if the OCR extraction returns a dictionary.
* The script saves the extracted invoice fields to a JSON file in the `output` directory. 

Note: The code seems to be designed to work with a specific local Ollama LLM model, and the `ollama_parser` module is not a standard library. The code also assumes that the `ocr_handler` and `text_cleaner` modules are implemented correctly and are available in the `ocr` and `utils` packages, respectively.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 7cc9badf-7525-4565-a1d9-486258bdccd7
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 7cc9badf-7525-4565-a1d9-486258bdccd7

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### Code File Summaries

#### debug_ocr.py
**Purpose:** Debugging tool for Optical Character Recognition (OCR) functionality, specifically designed to extract text from PDF files.

**Key Components:**
* Utilizes the `extract_text_from_pdf` function from `ocr.ocr_handler` to perform OCR operations.
* Provides a `debug_ocr` function to extract and print text from PDF files.

**Behavior:**
* Takes a PDF file path as input and prints extracted text for each page, truncated to 1000 characters.
* Prints usage instructions if run without a provided PDF file path.
* Relies on system dependencies: Tesseract OCR and Ollama for local LLMs.

**Usage:**
* Run via command line with a PDF file path: `python debug_ocr.py <pdf_path>`.

Note: The internal behavior of `extract_text_from_pdf` is uncertain, but it likely leverages libraries like `pytesseract` or `fitz` for OCR operations.


### üìÑ `main.py`
### main.py Summary

**Purpose:** 
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**
* Orchestrates invoice extraction through `main(pdf_path)`
* Utilizes `extract_text_from_pdf` for OCR, `generate_invoice_fields` for LLM-based field generation, and `clean_ocr_text` for text preprocessing

**Inputs and Outputs:**
* Input: PDF file path as a command-line argument
* Outputs:
  + Console: Structured invoice fields
  + File: JSON file in the `output` directory containing raw LLM output and structured invoice fields

**Side-Effects:**
* Creates an `output` directory if it does not exist
* Saves a JSON file with extraction results to the `output` directory

**Dependencies:**
* Python libraries: `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, `requests`
* External installations: `Ollama` AI model, `Tesseract OCR`

**Usage:**
Run the script with `python main.py <path_to_pdf>`, replacing `<path_to_pdf>` with the desired PDF file path.


### üìÑ `llm/ollama_parser.py`
### Code File Summaries

#### `llm/ollama_parser.py`

* **Purpose:** Parse invoice text using a local LLM API to extract structured information.
* **Key Functions:**
  * `generate_invoice_fields(text)`: Takes invoice text, sends a POST request to the LLM API, and returns parsed invoice fields in JSON format.
* **Inputs/Outputs:**
  * Input: `text` (invoice text)
  * Outputs: 
    * `json_data` (extracted invoice fields as a dictionary)
    * `raw_output` (raw LLM API response or error message)
* **Side-Effects:**
  * Sends a POST request to the local LLM API at `http://localhost:11434/api/generate`
  * Returns a dictionary with default empty values and an error message if the API request fails
* **Important Dependencies:**
  * `requests` library
  * Local LLM API (e.g., Ollama) running at `http://localhost:11434/api/generate`
* **Behavior and Intent:**
  * Uses a prompt-based approach to extract invoice fields from input text
  * Handles exceptions and returns a default dictionary with empty values if the API request or JSON parsing fails
* **Example Use Case:**
  * Call `generate_invoice_fields` with sample invoice text to extract structured information
  * Access extracted invoice fields (e.g., `invoice_id`, `total_amount`, `line_items`) from the returned `json_data` dictionary


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py

**Purpose:** 
Extracts text from scanned PDFs using Optical Character Recognition (OCR).

**Key Components:**

* `extract_text_from_pdf(pdf_path)`: Extracts text from each page of a scanned PDF.
 
**Functionality:**

* Takes a PDF file path as input and returns a dictionary with page numbers as keys and extracted text as values.
* Utilizes `fitz` for PDF handling, `pytesseract` for OCR, `PIL` for image processing, and system-installed `Tesseract OCR`.
* Raises a `FileNotFoundError` if the PDF file does not exist.
* Converts each page to a high-DPI image and extracts text using `pytesseract`, storing the results in a dictionary.

**Important Dependencies:**

* `fitz` (PyMuPDF)
* `pytesseract`
* `PIL` (Python Imaging Library)
* System-installed `Tesseract OCR` 

This function enables accurate text extraction from scanned PDFs by leveraging OCR capabilities and image processing.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries: `utils/text_cleaner.py`

The `text_cleaner.py` module is designed to clean and normalize text extracted from Optical Character Recognition (OCR) processes. 

* **Purpose**: Improve readability and usability of OCR text for further processing.
* **Key Functions**:
  * `clean_ocr_text(text)`: Cleans the input OCR text.
* **Inputs/Outputs**:
  * **Input**: `text` (string) - Raw OCR text.
  * **Output**: `text` (string) - Cleaned and normalized text.
* **Behavior and Intent**:
  * Removes extra whitespaces and line breaks.
  * Fixes broken words with hyphenations.
  * Normalizes punctuation and special characters.
  * Replaces common OCR misreads with correct equivalents.
  * Trims leading and trailing whitespaces.
* **Dependencies**: Python's built-in `re` (regular expression) module.
* **Side-Effects**: None detected.
This implementation is extensible to handle specific OCR issues and utilizes regular expressions for efficient text processing.

