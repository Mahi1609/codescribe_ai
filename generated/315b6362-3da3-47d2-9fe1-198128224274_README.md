# üëã Welcome to 315b6362-3da3-47d2-9fe1-198128224274

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The primary entry point, `main.py`, orchestrates the extraction process by:
* Extracting text from a PDF file using the `ocr_handler` module
* Preprocessing the extracted text with the `text_cleaner` utility
* Sending the cleaned text to the Ollama model for invoice field generation via the `ollama_parser` module
* Saving the structured output to a JSON file

Key dependencies include custom modules for OCR handling, Ollama model interaction, and text cleaning, with no external framework dependencies detected. The project can be run from the command line, taking a PDF file path as an argument, although the exact run command is not explicitly defined in the provided code snippet.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM) to extract structured invoice fields from PDF files.

#### main.py
**Purpose:** Extract invoice fields from PDF files using OCR and a local Ollama LLM.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the invoice extraction process.
**Inputs:**
* `pdf_path`: The path to the PDF file to extract invoice fields from.
**Outputs:**
* A JSON file containing the extracted invoice fields, saved to the "output" directory.
**Side-Effects:**
* Creates the "output" directory if it does not exist.
* Prints intermediate results and debug information to the console.
**Important Dependencies:**
* `ocr_handler.py`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `ollama_parser.py`: Provides the `generate_invoice_fields` function for LLM-based invoice field extraction.
* `text_cleaner.py`: Provides the `clean_ocr_text` function for preprocessing OCR-extracted text.
**Framework Patterns:**
* Utilizes a modular design, with separate modules for OCR extraction, LLM-based invoice field extraction, and text preprocessing.

#### Other Source Files
* `debug_ocr.py`: Not utilized in the provided code snippet.
* `llm/ollama_parser.py`: Provides the `generate_invoice_fields` function for LLM-based invoice field extraction.
* `ocr/ocr_handler.py`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `utils/text_cleaner.py`: Provides the `clean_ocr_text` function for preprocessing OCR-extracted text.

Note: The `debug_ocr.py` file is not utilized in the provided code snippet, and its purpose is uncertain without further context.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 315b6362-3da3-47d2-9fe1-198128224274
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 315b6362-3da3-47d2-9fe1-198128224274

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
## Code File Summary: `debug_ocr.py`

**Purpose:**  `debug_ocr.py` is a debugging script for the OCR pipeline. It takes a PDF file path as input and extracts text from each page, printing it to the console for inspection.

**Key Functions/Classes:**

* `debug_ocr(pdf_path)`: 
    * **Input:** `pdf_path` (string): Path to the PDF file.
    * **Output:** None. Prints extracted text to the console.
    * **Side-effects:** Prints debugging information to the console. Calls `extract_text_from_pdf` to obtain page-level text.

* `extract_text_from_pdf(pdf_path)`: 
    * **Input:** `pdf_path` (string): Path to the PDF file.
    * **Output:** Dictionary where keys are page numbers and values are extracted text for each page.
    * **Dependency:** Relies on the `extract_text_from_pdf` function from the `ocr.ocr_handler` module.

**Important Notes:**

* Assumes the `ocr.ocr_handler` module is available and contains the `extract_text_from_pdf` function.
* Truncates extracted text to 1000 characters per page, appending "..." if longer. 





### üìÑ `main.py`
## Code File Summary: main.py

**Purpose:**  This script automates the extraction of structured invoice data from PDF files.

**Key Functions/Classes:**

* `main(pdf_path)`:  Processes a PDF file, extracting invoice data and printing/saving the results.

**Inputs/Outputs:**

* **Input:** Path to a PDF file containing an invoice (`pdf_path`).
* **Output:**
    * Prints extracted invoice fields to the console.
    * Saves raw LLM response and structured invoice data to a JSON file in the "output" directory.

**Side Effects:**

* Creates an "output" directory if it doesn't exist.

**Dependencies:**

* **Python Libraries:** PIL, fitz, llm, ocr, pytesseract, requests
* **System:**
    * Locally installed Ollama (https://ollama.ai)
    * Tesseract OCR (installed via package manager, e.g., `sudo apt-get install tesseract-ocr`) 


**Workflow:**

1. `extract_text_from_pdf` (from `ocr.ocr_handler`) performs OCR on the input PDF.
2. `clean_ocr_text` (from `utils.text_cleaner`) preprocesses the OCR output.
3. `generate_invoice_fields` (from `llm.ollama_parser`) uses a local Ollama model to extract structured invoice data from the cleaned text.
4. Results are printed and saved to JSON. 



### üìÑ `llm/ollama_parser.py`
## llm/ollama_parser.py Summary

This file provides a function to extract structured data from invoice text using an Ollama LLM. 

**Purpose:**

- Parse invoice text and identify key fields like invoice ID, dates, amounts, supplier information, and line items.

**Key Functions/Classes:**

- `generate_invoice_fields(text)`: Processes invoice text and returns a dictionary of extracted fields in JSON format, along with the raw Ollama API output.

**Inputs/Outputs:**

- **Input:** `text` (string) - The invoice text to be parsed.
- **Output:**
    - `json_data` (dict): A dictionary containing extracted invoice fields in JSON format.
    - `raw_output` (string): Raw output from the Ollama API or an error message if parsing fails.

**Side Effects:**

- Sends a POST request to a local Ollama API endpoint (`http://localhost:11434/api/generate`) for text processing.

**Dependencies:**

- **Python:** `requests`, `json`
- **System:** Ollama (installed from https://ollama.ai), Tesseract OCR (installed via `sudo apt-get install tesseract-ocr`) 

**Framework Patterns:**

- Leverages the Ollama API for LLM-based text processing. 





### üìÑ `ocr/ocr_handler.py`
## ocr/ocr_handler.py

**Purpose:** This file provides a function to extract text content from each page of a scanned PDF document using OCR.

**Key Function:**

- `extract_text_from_pdf(pdf_path)`:  Processes a PDF file (specified by `pdf_path`) and returns a dictionary mapping page numbers to the extracted text content for each page.

**Dependencies:**

- `fitz` (PyMuPDF):  For PDF manipulation.
- `os`: For file existence checks.
- `pytesseract`: For OCR processing.
- `PIL`: For handling image data extracted from the PDF. 





### üìÑ `utils/text_cleaner.py`
## utils/text_cleaner.py

This file provides a utility function, `clean_ocr_text`, for preprocessing text extracted from Optical Character Recognition (OCR) processes. 

**Purpose:**

* Enhance the quality and consistency of OCR output by addressing common issues like extraneous whitespace, hyphenation errors, and non-ASCII characters.

**Key Functions/Classes:**

* `clean_ocr_text(text)`: Takes raw OCR text as input and returns a cleaned version.

**Inputs/Outputs:**

* **Input:** `text` (str): Raw OCR text.
* **Output:** `text` (str): Cleaned OCR text.

**Behavior Summary:**

* Normalizes whitespace and line breaks for consistent formatting.
* Corrects hyphenation errors caused by OCR splitting words across lines.
* Removes non-ASCII characters and normalizes whitespace around punctuation.
* Implements specific replacements for common OCR errors.

**Dependencies:**

* `re`: Python's regular expression library. 




