# üëã Welcome to 4fcfa363-6015-49ef-a9f8-d249e3df25f0

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The primary entry point, `main.py`, orchestrates the extraction process by:
* Extracting text from PDF files using the `ocr_handler` module
* Preprocessing the extracted text with the `text_cleaner` utility
* Sending the cleaned text to the Ollama model for invoice field generation via the `ollama_parser` module
* Saving the structured output to a JSON file

Key dependencies include the `ocr_handler`, `ollama_parser`, and `text_cleaner` modules, which handle OCR extraction, LLM interaction, and text preprocessing, respectively. The project's purpose is to automate the extraction of invoice fields from PDF files, leveraging both OCR and LLM technologies.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

#### main.py
**Purpose:** Extract invoice fields from a given PDF file.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the extraction process.
* `extract_text_from_pdf(pdf_path)`: Extracts text from a PDF file using OCR (defined in `ocr/ocr_handler.py`).
* `generate_invoice_fields(cleaned_text)`: Sends the preprocessed text to the Ollama model to extract structured invoice fields (defined in `llm/ollama_parser.py`).
* `clean_ocr_text(text)`: Cleans and preprocesses the extracted text before sending it to the LLM (defined in `utils/text_cleaner.py`).
**Inputs:**
* `pdf_path`: The path to the PDF file to extract invoice fields from.
**Outputs:**
* A JSON file containing the extracted invoice fields and the raw LLM response, saved to the `output` directory.
**Side-Effects:**
* Creates the `output` directory if it does not exist.
* Prints various debug messages and previews of the extraction process to the console.
**Dependencies:**
* `os` and `sys` for file system interactions and command-line argument parsing.
* `json` for serializing the output to a JSON file.
**Framework Patterns:**
* Uses a modular design, with separate modules for OCR handling, LLM interaction, and text cleaning.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 4fcfa363-6015-49ef-a9f8-d249e3df25f0
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 4fcfa363-6015-49ef-a9f8-d249e3df25f0

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### Code File Summaries: `debug_ocr.py`

The `debug_ocr.py` script is a debugging tool for verifying the accuracy of Optical Character Recognition (OCR) text extraction from PDF files. 

* **Purpose**: Extract and display text from a given PDF file using OCR capabilities.
* **Key Functions**:
  * `debug_ocr(pdf_path)`: Extracts text from a PDF file and prints it to the console.
  * `extract_text_from_pdf(pdf_path)` (imported from `ocr.ocr_handler`): Performs the actual OCR text extraction.
* **Inputs/Outputs**:
  * Input: `pdf_path` - the file path to the PDF file.
  * Output: Extracted text printed to the console, truncated to 1000 characters per page if necessary.
* **Side-Effects**:
  * Prints usage instructions if run without a PDF file path.
  * Requires `ocr.ocr_handler` and its dependencies (e.g., Tesseract OCR) to function correctly.
* **Important Dependencies**: 
  * `ocr.ocr_handler` module
  * Tesseract OCR (installed via `sudo apt-get install tesseract-ocr`)
* **Usage**: Run the script from the command line, providing the PDF file path as an argument: `python debug_ocr.py <pdf_path>`


### üìÑ `main.py`
### Code File Summaries: main.py

The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**
* Orchestrates invoice extraction using OCR and LLM
* Utilizes `extract_text_from_pdf`, `generate_invoice_fields`, and `clean_ocr_text` functions from respective modules

**Input/Output:**
* Input: PDF file path (command-line argument)
* Output: JSON file containing extracted invoice fields (saved in `output` directory)

**Behavior:**
* Creates `output` directory if it does not exist
* Saves extracted invoice fields as a JSON file
* Prints extracted invoice fields to the console

**Dependencies:**
* `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, and `Ollama` (with `Tesseract OCR` installed separately)

**Execution:**
* Run using `python main.py path/to/invoice.pdf` to extract invoice fields and save output in the `output` directory.


### üìÑ `llm/ollama_parser.py`
### Code File Summaries

#### `llm/ollama_parser.py`

* **Purpose:** Parse invoice text using a local LLM API to extract structured information.
* **Key Functions:**
  + `generate_invoice_fields(text)`: Sends a prompt to the local LLM API to extract relevant fields from invoice text.
* **Inputs/Outputs:**
  + Input: `text` (invoice text)
  + Outputs: 
    - `json_data` (parsed invoice data in JSON format)
    - `raw_output` (raw LLM API response or error message)
* **Side-Effects:**
  + Sends a POST request to the local LLM API at `http://localhost:11434/api/generate`
  + Returns default empty values if API request or JSON parsing fails
* **Important Dependencies:**
  + `requests` library for HTTP requests
  + Local LLM API (Mistral model) at `http://localhost:11434/api/generate`
  + `json` library for JSON parsing and generation
* **Behavior and Intent:** Provides a structured prompt to the local LLM API to extract invoice fields, handling potential exceptions and ensuring consistent output format.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py

The `ocr_handler.py` file provides a function to extract text from scanned PDFs using Optical Character Recognition (OCR).

**Key Features:**
* Extracts text from each page of a scanned PDF
* Returns a dictionary with page numbers as keys and extracted text as values

**Important Details:**
* Inputs: `pdf_path` (string) - the file path to the scanned PDF
* Outputs: Dictionary with page numbers as keys and extracted text as values
* Side-Effects: Raises a `FileNotFoundError` if the PDF file does not exist, opens and closes the PDF document using `fitz`
* Dependencies: `fitz` (PyMuPDF), `pytesseract`, `PIL` (Python Imaging Library)
* Requirements: Tesseract OCR installation (e.g., `sudo apt-get install tesseract-ocr`)

**Behavior and Intent:**
This code iterates through each page of a scanned PDF, applies OCR using `pytesseract`, and stores the extracted text in a dictionary. The function uses a high DPI (300) for better OCR accuracy and relies on `fitz` for PDF processing and `PIL` for image conversion. The accuracy of the extracted text depends on the quality of the scanned PDF and the OCR engine used.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries: `utils/text_cleaner.py`

#### Purpose
The `text_cleaner.py` module cleans and normalizes text extracted from Optical Character Recognition (OCR) processes, enhancing readability and usability for further processing.

#### Key Components
* `clean_ocr_text(text)`: The primary function for cleaning and normalizing input OCR text.

#### Functionality
* **Input**: OCR text as a string
* **Output**: Cleaned and normalized OCR text as a string
* **Side-Effects**: None

#### Dependencies and Behavior
This module utilizes Python's built-in `re` module for text processing. The `clean_ocr_text` function:
* Removes unnecessary whitespace and line breaks
* Repairs hyphenated words at line ends
* Normalizes punctuation, special characters, and non-ASCII characters
* Corrects common OCR misreads and standardizes characters for consistency

Designed to work with OCR libraries like `pytesseract` and `fitz`, this function improves the accuracy and usability of extracted text.

