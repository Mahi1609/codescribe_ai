# üëã Welcome to 40144872-81b3-45a2-9353-1994bc703133

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama LLM model. The primary entry point, `main.py`, orchestrates the extraction process by:
* Extracting text from a provided PDF file using the `ocr_handler` module
* Preprocessing the extracted text with the `text_cleaner` utility
* Sending the cleaned text to the Ollama model for invoice field generation via the `ollama_parser` module
* Saving the structured output to a JSON file

Key dependencies include the `ocr_handler`, `ollama_parser`, and `text_cleaner` modules, which handle OCR extraction, invoice field generation, and text preprocessing, respectively.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

#### main.py
**Purpose:** Extract invoice fields from a given PDF file.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the extraction process.
* `extract_text_from_pdf(pdf_path)`: Performs OCR on the input PDF to extract text.
* `generate_invoice_fields(cleaned_text)`: Sends the preprocessed text to the Ollama model to extract structured invoice fields.
* `clean_ocr_text(text)`: Cleans and preprocesses the extracted text before sending it to the LLM.

**Inputs:**
* `pdf_path`: The path to the input PDF file.

**Outputs:**
* A JSON file containing the extracted invoice fields and the raw model response, saved to the "output" directory.

**Side-Effects:**
* Creates the "output" directory if it does not exist.
* Saves the extracted invoice fields to a JSON file.

**Important Dependencies:**
* None detected, but the code relies on the `ollama_parser` and `ocr_handler` modules, which are part of the project.

**Framework Patterns:**
* The code uses a modular approach, with separate modules for OCR handling, text cleaning, and LLM interaction.
* The `main` function serves as the entry point, orchestrating the extraction process and handling user input. 

To run this script, save it as `main.py` and execute it from the command line, providing the path to the input PDF file as an argument: `python main.py <path_to_pdf>`.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 40144872-81b3-45a2-9353-1994bc703133
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 40144872-81b3-45a2-9353-1994bc703133

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### Code File Summaries: debug_ocr.py

* **Purpose:** Extract and display text from a PDF file using Optical Character Recognition (OCR) for debugging purposes.
* **Key Functions:**
  + `debug_ocr(pdf_path)`: Extracts text from a PDF file and prints it to the console.
* **Inputs/Outputs:**
  + Input: PDF file path (command-line argument).
  + Output: Extracted text from each page, printed to the console (first 1000 characters per page).
* **Side-Effects:** Prints extracted text to the console for debugging and verification.
* **Dependencies:** 
  + Custom `ocr.ocr_handler` module (specifically, `extract_text_from_pdf` function).
  + Tesseract OCR and potentially other OCR-related libraries (e.g., `pytesseract`, `fitz`, `llm`, `ocr`).
* **Usage:** Run from the command line, providing a PDF file path as an argument (e.g., `python debug_ocr.py path/to/example.pdf`). Ensure all necessary dependencies are installed and configured properly.


### üìÑ `main.py`
### main.py Summary

**Purpose:** 
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**

* Orchestrates the extraction process using OCR and Ollama LLM
* Utilizes `extract_text_from_pdf`, `generate_invoice_fields`, and `clean_ocr_text` functions

**Functionality:**

* Extracts text from PDF using OCR
* Preprocesses extracted text
* Generates structured invoice fields using Ollama LLM
* Saves output as a JSON file and prints to console

**Dependencies and Requirements:**

* Python libraries: `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, and `requests`
* Ollama LLM and Tesseract OCR installed

**Usage:**
Run the script with a PDF file path as a command-line argument: `python main.py <path_to_pdf>`


### üìÑ `llm/ollama_parser.py`
### Code File Summaries

#### `llm/ollama_parser.py`

* **Purpose:** Extract structured information from invoice text using a local LLM API.
* **Key Functions:**
  + `generate_invoice_fields(text)`: Extracts relevant fields from invoice text via the LLM API.
* **Inputs/Outputs:**
  + **Input:** `text` (string) - invoice text to be parsed.
  + **Outputs:**
    - `json_data` (dict) - extracted invoice fields.
    - `raw_output` (string) - raw LLM API output or error message.
* **Side-Effects:**
  + Sends a POST request to the local LLM API at `http://localhost:11434/api/generate`.
  + Returns a default dictionary with empty strings if the API request fails.
* **Dependencies:**
  + `requests` library for HTTP requests.
  + Local LLM API (e.g., Ollama) at `http://localhost:11434`.
* **Behavior and Intent:** The `generate_invoice_fields` function uses a local LLM API to extract structured information from invoice text, returning both parsed JSON data and raw API output. If the API request fails, it returns a default dictionary with empty strings for all fields.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py

The `ocr_handler.py` file provides a function to extract text from scanned PDFs using Optical Character Recognition (OCR).

* **Purpose:** Extract text from scanned PDFs.
* **Key Function:** `extract_text_from_pdf(pdf_path)` extracts text from each page of a scanned PDF.
* **Inputs/Outputs:**
  * Input: `pdf_path` (str) - The file path to the scanned PDF.
  * Output: A dictionary with page numbers (prefixed with "page_") as keys and extracted text as values.
* **Side-Effects:**
  * Raises a `FileNotFoundError` if the specified PDF file does not exist.
  * Opens and closes the PDF document using `fitz`.
* **Dependencies:**
  * `fitz` (PyMuPDF) for PDF processing
  * `pytesseract` for OCR functionality
  * `PIL` (Python Imaging Library) for image processing
  * System dependencies: `tesseract-ocr` (install via `sudo apt-get install tesseract-ocr`)

This function iterates over each page of the PDF, applies OCR using `pytesseract`, and returns a dictionary with the extracted text from each page. Note that `ollama` installation from `https://ollama.ai` is required for running local LLMs, although it is not directly used in this code snippet.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries: `utils/text_cleaner.py`

The `text_cleaner.py` module is designed to clean and normalize text extracted from Optical Character Recognition (OCR) processes. 

* **Purpose**: Improve readability and usability of OCR text for further processing.
* **Key Function**: 
  * `clean_ocr_text(text)`: Cleans and normalizes input OCR text.
* **Inputs/Outputs**:
  * Input: `text` (string) - Raw OCR text.
  * Output: `text` (string) - Cleaned and normalized text.
* **Side-Effects**: None.
* **Important Dependencies**: Python's built-in `re` (regular expression) module.
* **Behavior and Intent**: 
  * Removes extra whitespaces and line breaks.
  * Fixes broken words with hyphenations at line ends.
  * Normalizes punctuation and special characters.
  * Replaces common OCR misreads.
  * Strips leading and trailing whitespaces.
 
This module is intended for use as a preprocessing step to improve the accuracy and quality of OCR text for subsequent processing or analysis, particularly with tools like Tesseract OCR.

