# üëã Welcome to 2ac9dca4-010e-414f-bb14-825f393ed954

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The main entry point, `main.py`, orchestrates this process by: 
* Extracting text from PDFs via the `ocr_handler` module
* Preprocessing the extracted text with the `text_cleaner` utility
* Sending the cleaned text to the Ollama model for invoice field extraction
* Saving the structured output to a JSON file. 
Key dependencies include custom modules for OCR handling, Ollama model interaction, and text cleaning, with the project relying on standard Python libraries such as `os`, `sys`, and `json` for file system interactions and data serialization.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM) to extract structured invoice fields from PDF documents.

#### main.py
**Purpose:** Extract invoice fields from PDF documents using OCR and a local Ollama LLM.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the invoice extraction process.
**Inputs:**
* `pdf_path`: The path to the PDF document to extract invoice fields from.
**Outputs:**
* A JSON file containing the extracted invoice fields and the raw LLM response, saved to the "output" directory.
**Side-Effects:**
* Creates the "output" directory if it does not exist.
* Prints intermediate results and debugging information to the console.
**Dependencies:**
* `ocr.ocr_handler`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `llm.ollama_parser`: Provides the `generate_invoice_fields` function for LLM-based invoice field extraction.
* `utils.text_cleaner`: Provides the `clean_ocr_text` function for preprocessing the OCR-extracted text.

The script follows these steps:
* Extracts text from the PDF document using OCR.
* Combines the extracted text if it is returned as a dictionary (multi-page PDF).
* Preprocesses the extracted text using the `clean_ocr_text` function.
* Sends the preprocessed text to the local Ollama LLM to extract structured invoice fields.
* Saves the extracted invoice fields and the raw LLM response to a JSON file.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 2ac9dca4-010e-414f-bb14-825f393ed954
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 2ac9dca4-010e-414f-bb14-825f393ed954

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### debug_ocr.py

**Purpose:** 
Extracts and displays text from a given PDF file using Optical Character Recognition (OCR) for debugging purposes.

**Key Components:**

* The `debug_ocr` function, which orchestrates the text extraction process
* The `extract_text_from_pdf` function (imported from `ocr.ocr_handler`), which performs the actual OCR operation

**Behavior:**

* Takes a PDF file path as a command-line argument
* Extracts text from each page of the PDF using OCR
* Prints the extracted text to the console, truncating to 1000 characters per page with an ellipsis (`...`) if necessary

**Dependencies and Requirements:**

* `ocr.ocr_handler` module
* System dependencies: Tesseract OCR and Ollama (installable from https://ollama.ai)
* Installation of Tesseract OCR via `sudo apt-get install tesseract-ocr`

**Usage:**
Run the script from the command line, providing the path to a PDF file as an argument: `python debug_ocr.py <pdf_path>`


### üìÑ `main.py`
### main.py Summary

**Purpose:** 
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**
* Orchestrates invoice extraction using OCR and LLM
* Utilizes `extract_text_from_pdf`, `generate_invoice_fields`, and `clean_ocr_text` functions

**Functionality:**
* Takes a PDF file path as input, extracts text using OCR, and generates structured invoice fields using the Ollama model
* Outputs extracted fields to the console and saves a JSON file containing raw model output and structured fields to the "output" directory

**Dependencies and Requirements:**
* Python libraries: `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, and `requests`
* External installations: `Ollama` AI model and `Tesseract OCR`

**Usage:**
* Run the script from the command line, providing the path to a PDF file as an argument: `python main.py <path_to_pdf>`


### üìÑ `llm/ollama_parser.py`
### Code File Summaries: `llm/ollama_parser.py`

The `ollama_parser.py` file contains a function to parse invoice text and extract structured information using a local LLM API.

* **Purpose**: Extract invoice fields from text using a local LLM API.
* **Key Functions**:
  + `generate_invoice_fields(text)`: Takes invoice text, sends a POST request to the local LLM API, and returns extracted fields in JSON format.
* **Inputs/Outputs**:
  + Input: `text` (string) - invoice text to be parsed
  + Outputs: 
    - `json_data` (dict) - extracted invoice fields in JSON format
    - `raw_output` (string) - raw LLM API output or error message
* **Side-Effects**:
  + Sends a POST request to the local LLM API at `http://localhost:11434/api/generate`
  + Returns a default dictionary with empty strings if the API request fails
* **Important Dependencies**:
  + `requests` library for HTTP requests
  + Local LLM API (e.g., Ollama) running on `http://localhost:11434`
* **Behavior and Intent**: The `generate_invoice_fields` function extracts structured information from invoice text using a local LLM API, returning extracted fields in JSON format or a default dictionary if the API request fails.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py

**Purpose:** 
Extracts text from scanned PDFs using Optical Character Recognition (OCR).

**Key Components:**

* `extract_text_from_pdf(pdf_path)`: Extracts text from each page of a scanned PDF.
 
**Functionality:**

* Takes a PDF file path as input and returns a dictionary with page numbers as keys and extracted text as values.
* Utilizes `fitz` for PDF handling, `pytesseract` for OCR, and `PIL` for image processing.
* Relies on system-installed Tesseract OCR.

**Behavior:**

* Checks for the PDF file's existence, opening and closing it using `fitz`.
* Iterates over pages, converting them to high-DPI images for accurate OCR.
* Extracts text from each page's image using `pytesseract` and stores it in a dictionary.
* Returns the dictionary of extracted text, raising a `FileNotFoundError` if the PDF file does not exist.

**Important Considerations:**

* Requires Tesseract OCR installation (e.g., `sudo apt-get install tesseract-ocr`).
* Does not handle OCR process exceptions, which may need to be added based on the specific use case.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries: `utils/text_cleaner.py`

#### Purpose
The `text_cleaner.py` module cleans and normalizes text extracted from Optical Character Recognition (OCR) processes.

#### Key Components
* `clean_ocr_text(text)`: Cleans the input OCR text by removing extra whitespaces, fixing broken words, normalizing punctuation, replacing common OCR errors, and standardizing misread characters.

#### Inputs/Outputs
* Input: `text` (string) - Raw OCR text
* Output: `text` (string) - Cleaned and normalized text

#### Dependencies
* Python's built-in `re` (regular expression) module for text processing

#### Behavior and Intent
The `clean_ocr_text` function improves text readability by:
* Removing extra whitespaces and line breaks
* Fixing hyphenated words
* Normalizing punctuation and special characters
* Replacing common OCR errors
* Standardizing misread characters

#### Side-Effects
None, as the function only modifies the input text in-memory and returns the cleaned text. 

This module is a useful utility for text processing pipelines involving OCR-extracted text and can be extended to handle more OCR-specific issues as needed.

