# üëã Welcome to 03dce0bd-5360-4315-8511-1dca1eabc427

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The primary entry point, `main.py`, orchestrates the extraction process by:
* Extracting text from a PDF file using OCR
* Preprocessing the extracted text
* Sending the text to the Ollama model for invoice field extraction
* Saving the structured output to a JSON file

Key functions and classes include `extract_text_from_pdf` from `ocr_handler.py`, `generate_invoice_fields` from `ollama_parser.py`, and `clean_ocr_text` from `text_cleaner.py`. The project relies on standard Python libraries, with no external dependencies detected. To run the project, execute `main.py` with a PDF file path as a command-line argument.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM) to extract structured invoice fields from PDF files.

#### main.py
**Purpose:** Extract invoice fields from PDF files using OCR and a local Ollama LLM.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the extraction process.
**Inputs:**
* `pdf_path`: The path to the PDF file to extract invoice fields from.
**Outputs:**
* A JSON file containing the extracted invoice fields, saved to the "output" directory.
**Side-Effects:**
* Creates the "output" directory if it does not exist.
* Prints intermediate results and debugging information to the console.
**Important Dependencies:**
* `ocr.ocr_handler`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `llm.ollama_parser`: Provides the `generate_invoice_fields` function for LLM-based invoice field extraction.
* `utils.text_cleaner`: Provides the `clean_ocr_text` function for preprocessing OCR-extracted text.

The script follows these steps:
* Extracts text from the PDF file using OCR.
* Combines text from multiple pages (if applicable).
* Preprocesses the extracted text.
* Sends the preprocessed text to the local Ollama model for invoice field extraction.
* Saves the extracted invoice fields to a JSON file.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 03dce0bd-5360-4315-8511-1dca1eabc427
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 03dce0bd-5360-4315-8511-1dca1eabc427

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### debug_ocr.py
#### Purpose
Extracts and displays text from a given PDF file using Optical Character Recognition (OCR) techniques.

#### Key Components
* **Main Function**: `debug_ocr(pdf_path)` - extracts text from a PDF file and prints it to the console.
* **OCR Operation**: Performed by `extract_text_from_pdf(pdf_path)` from `ocr.ocr_handler`, which is responsible for the actual OCR operation.

#### Inputs and Outputs
* **Input**: PDF file path (`pdf_path`)
* **Output**: Extracted text from each page, printed to the console (first 1000 characters per page, with an ellipsis indicating more text)

#### Behavior and Dependencies
* Prints extracted text to the console
* Exits if `pdf_path` argument is not provided
* Depends on:
  + `ocr.ocr_handler` module for OCR operations
  + System dependency: Tesseract OCR

#### Usage
Run the script from the command line, providing the PDF file path as an argument:
```bash
python debug_ocr.py /path/to/example.pdf
```


### üìÑ `main.py`
### main.py Summary

**Purpose:** 
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**

* Orchestrates invoice extraction through `main(pdf_path)`
* Utilizes OCR for text extraction via `extract_text_from_pdf(pdf_path)`
* Employs Ollama model for structured field extraction through `generate_invoice_fields(cleaned_text)`
* Cleans and preprocesses OCR text using `clean_ocr_text(text)`

**Functionality:**

* Takes a PDF file path as input
* Outputs:
  + Structured invoice fields to the console
  + A JSON file with raw model output and structured fields in the `output` directory
* Creates the `output` directory if it does not exist

**Dependencies and Requirements:**

* Python libraries: `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, `requests`
* Ollama LLM from https://ollama.ai
* Tesseract OCR installation (e.g., `sudo apt-get install tesseract-ocr`)

**Usage:**
Run the script with `python main.py <path_to_pdf>`, replacing `<path_to_pdf>` with the input PDF file path.


### üìÑ `llm/ollama_parser.py`
### Code File Summaries

#### `llm/ollama_parser.py`

* **Purpose:** Parse invoice text and extract structured information using a local LLM API.
* **Key Functions:**
  + `generate_invoice_fields(text)`: Takes invoice text, sends a POST request to the local LLM API, and returns extracted invoice fields in JSON format.
* **Inputs/Outputs:**
  + Input: `text` (invoice text)
  + Outputs: 
    - `json_data` (extracted invoice fields in JSON format)
    - `raw_output` (raw LLM API output or error message)
* **Side-Effects:**
  + Sends a POST request to the local LLM API, potentially impacting network usage and API limits.
  + Returns default empty values if the LLM API is unavailable or returns an error.
* **Dependencies:**
  + `requests` library for HTTP requests
  + Local LLM API (running on `http://localhost:11434/api/generate`)
  + `json` library for JSON parsing and generation
* **Behavior and Intent:** Extracts structured information from invoice text using a local LLM API, returning the extracted fields in JSON format. Requires the local LLM API to be running and accessible.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py Summary

**Purpose:** Extract text from scanned PDFs using Optical Character Recognition (OCR).

**Key Functions:**
* `extract_text_from_pdf(pdf_path)`: Extracts text from each page of a scanned PDF.

**Behavior and Dependencies:**
* Utilizes `fitz` for PDF processing, `pytesseract` for OCR, `PIL` for image processing, and `os` for file path checking.
* Iterates over each PDF page, converting it to a high-DPI image for accurate OCR, and stores extracted text in a dictionary with page numbers as keys.

**Inputs/Outputs:**
* Input: `pdf_path` (str) - The file path to the scanned PDF.
* Output: A dictionary (`extracted_pages`) containing extracted text from each page.

**Side-Effects:**
* Raises a `FileNotFoundError` if the specified `pdf_path` does not exist.
* Opens and closes the PDF document using `fitz.open()` and `doc.close()`. 

Note: This function assumes proper installation and configuration of dependencies, including Tesseract OCR, and its accuracy depends on the scanned PDF's quality and the OCR engine used.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries: `utils/text_cleaner.py`

The `text_cleaner.py` module is designed to clean and normalize text extracted from Optical Character Recognition (OCR) processes. 

* **Purpose**: Improve readability and usability of OCR text for further processing.
* **Key Function**: `clean_ocr_text(text)` - cleans and normalizes input OCR text.
* **Inputs/Outputs**:
  * Input: `text` (string) - raw OCR text.
  * Output: cleaned and normalized text (string).
* **Behavior and Intent**: Addresses common OCR issues by removing extra whitespaces, fixing broken words, normalizing punctuation, and correcting common misreads using regular expressions (`re` module).
* **Dependencies**: Relies on the Python standard library's `re` module.
* **Side-Effects**: None detected, operating solely on input text without modifying external state.

