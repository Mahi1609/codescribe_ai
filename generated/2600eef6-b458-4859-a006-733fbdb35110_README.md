# üëã Welcome to 2600eef6-b458-4859-a006-733fbdb35110

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama LLM (Large Language Model) to process PDF files. The primary function is handled by the `main.py` file, which orchestrates the following key steps: 
* OCR extraction of text from a PDF file using `ocr_handler.py`
* Preprocessing of the extracted text with `text_cleaner.py`
* Sending the cleaned text to the Ollama model for invoice field extraction via `ollama_parser.py`
* Saving the structured output to a JSON file. 
The project relies on standard Python libraries and does not appear to have external dependencies beyond what is included in the Python environment.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

#### main.py
**Purpose:** Extract invoice fields from a given PDF file.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the extraction process.
* `extract_text_from_pdf(pdf_path)`: Performs OCR on the input PDF to extract text.
* `clean_ocr_text(text)`: Preprocesses the extracted text for better LLM input.
* `generate_invoice_fields(cleaned_text)`: Sends the preprocessed text to the Ollama model to extract structured invoice fields.

**Inputs:**
* `pdf_path`: The path to the input PDF file.

**Outputs:**
* Extracted invoice fields in a structured format (JSON).
* A debug preview of the OCR result.
* A saved JSON file containing the raw output and structured fields.

**Side-Effects:**
* Creates an `output` directory if it does not exist.
* Saves the extracted output to a JSON file in the `output` directory.

**Dependencies:**
* `os` for path normalization and directory creation.
* `sys` for command-line argument handling.
* `json` for output serialization.
* `ocr_handler` for OCR text extraction.
* `ollama_parser` for invoice field extraction using the Ollama LLM.
* `text_cleaner` for preprocessing the extracted text.

**Framework Patterns:**
* Modular design with separate modules for OCR, text cleaning, and LLM interaction.
* Command-line interface for input PDF path specification.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 2600eef6-b458-4859-a006-733fbdb35110
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 2600eef6-b458-4859-a006-733fbdb35110

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### Code File Summaries: debug_ocr.py

The `debug_ocr.py` script is designed to extract and display text from a given PDF file using Optical Character Recognition (OCR) for debugging purposes.

**Key Features:**
* Extracts text from PDF files using OCR
* Prints extracted text from each page, truncated to 1000 characters per page
* Indicates page numbers for extracted text

**Usage:**
* Input: PDF file path as a command-line argument
* Output: Printed extracted text for each page
* Side-effects: Prints usage instructions if input is missing

**Dependencies:**
* `ocr.ocr_handler` module for OCR operations
* System dependencies: Tesseract OCR and Ollama (for local LLMs)

**Running the Script:**
Execute from the command line, providing the PDF file path as an argument:
```bash
python debug_ocr.py /path/to/example.pdf
```


### üìÑ `main.py`
### main.py Summary

**Purpose:** 
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**

* Orchestrates invoice extraction using OCR and Ollama LLM
* Utilizes `extract_text_from_pdf`, `generate_invoice_fields`, and `clean_ocr_text` functions from respective modules

**Functionality:**

* Extracts text from PDF using OCR
* Preprocesses extracted text
* Sends preprocessed text to Ollama model for invoice field extraction
* Saves extracted invoice fields and raw output to a JSON file

**Dependencies and Requirements:**

* Python libraries: `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, and `requests`
* System installations: `Ollama` AI model and `Tesseract OCR`

**Usage:**
Run the script with a PDF file path as a command-line argument: `python main.py <path_to_pdf>` 

This will create an `output` directory (if it doesn't exist) and save the extracted invoice fields and raw output to a JSON file within it.


### üìÑ `llm/ollama_parser.py`
### Code File Summaries: `llm/ollama_parser.py`

The `ollm/ollama_parser.py` file serves as an interface to extract structured information from invoice text using a local Large Language Model (LLM) API.

**Key Components:**
* `generate_invoice_fields(text)`: Extracts relevant invoice fields from input text using the local LLM API.

**Functionality:**
* Takes invoice text as input and sends a prompt to the local LLM API.
* Returns extracted data in JSON format, including fields such as invoice ID, date, total amount, supplier name, and line items.
* If API request or JSON parsing fails, returns a default empty dictionary with all fields set to empty strings.

**Dependencies:**
* `requests` library for sending HTTP requests to the LLM API.
* Local LLM API (e.g., Ollama) running on `http://localhost:11434` with the "mistral" model.

**Behavior:**
* Sends a POST request to the local LLM API.
* Handles API request failures by returning a default empty dictionary.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py
#### Purpose
The `ocr_handler.py` file contains a function to extract text from scanned PDFs using Optical Character Recognition (OCR).

#### Key Components
* **Function**: `extract_text_from_pdf(pdf_path)`
* **Inputs**:
  + `pdf_path` (string): path to the scanned PDF file
* **Outputs**:
  + Dictionary with page numbers (prefixed with "page_") as keys and extracted text as values
* **Side-Effects**:
  + Raises `FileNotFoundError` if the PDF file does not exist
  + Opens and closes the PDF document using `fitz`
* **Dependencies**:
  + `fitz` (PyMuPDF) for PDF processing
  + `pytesseract` for OCR functionality
  + `PIL` for image processing
  + `os` for file path checking

#### Behavior and Intent
This code extracts text from each page of a scanned PDF using OCR, storing the results in a dictionary with page numbers as keys. It utilizes `fitz` for PDF processing, `pytesseract` for OCR, and `PIL` for image processing, ensuring high-quality text extraction with a DPI of 300.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries: `utils/text_cleaner.py`

The `text_cleaner.py` module is designed to clean and normalize text extracted from Optical Character Recognition (OCR) processes. 

* **Purpose**: Improve the readability and usability of OCR text for further processing.
* **Key Functions**: 
  * `clean_ocr_text(text)`: Cleans and normalizes the input OCR text.
* **Inputs/Outputs**:
  * **Input**: Raw OCR text (string)
  * **Output**: Cleaned and normalized text (string)
* **Side-Effects**: None
* **Important Dependencies**: Python's built-in `re` (regular expression) module
* **Behavior and Intent**:
  * Standardizes text format by removing extra whitespaces and line breaks
  * Fixes broken words and normalizes punctuation and special characters
  * Addresses common OCR misrecognitions with corrections (e.g., "lnvoice" to "Invoice")
  * Designed to be extensible for handling various OCR issues

