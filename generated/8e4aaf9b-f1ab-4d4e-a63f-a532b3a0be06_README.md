# üëã Welcome to 8e4aaf9b-f1ab-4d4e-a63f-a532b3a0be06

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The `main.py` file serves as the entry point, orchestrating the following key steps: 
* OCR extraction of text from PDF files using the `ocr_handler` module
* Text preprocessing with the `text_cleaner` utility
* Sending the cleaned text to the Ollama model for invoice field extraction using the `ollama_parser` module
* Saving the structured output to a JSON file. 
The project relies on Python's standard library for file handling, system interactions, and JSON encoding, with no external dependencies detected.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM) to extract structured invoice fields from PDF documents.

#### main.py
**Purpose:** Extract invoice fields from PDF documents using OCR and a local Ollama LLM.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the invoice extraction process.
**Inputs:**
* `pdf_path`: The path to the PDF document from which to extract invoice fields.
**Outputs:**
* A JSON file containing the extracted invoice fields, saved to the "output" directory.
**Side-Effects:**
* Creates the "output" directory if it does not exist.
* Saves the extracted invoice fields to a JSON file.
**Important Dependencies:**
* `ocr_handler.py`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `ollama_parser.py`: Provides the `generate_invoice_fields` function for LLM-based invoice field extraction.
* `text_cleaner.py`: Provides the `clean_ocr_text` function for preprocessing the OCR-extracted text.
**Framework Patterns:**
* Utilizes a modular design, with separate modules for OCR extraction, LLM-based invoice field extraction, and text preprocessing.

#### Other Source Files
* `debug_ocr.py`: Not utilized in the provided code snippet.
* `llm/ollama_parser.py`: Provides the `generate_invoice_fields` function for LLM-based invoice field extraction.
* `ocr/ocr_handler.py`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `utils/text_cleaner.py`: Provides the `clean_ocr_text` function for preprocessing the OCR-extracted text.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 8e4aaf9b-f1ab-4d4e-a63f-a532b3a0be06
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 8e4aaf9b-f1ab-4d4e-a63f-a532b3a0be06

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
## Code File Summaries: debug_ocr.py

**Purpose:** This script is a debugging tool for the OCR functionality within the project. It extracts text from a PDF file and displays it page by page for inspection.

**Key Functions/Classes:**

* `debug_ocr(pdf_path)`: Takes the path to a PDF file as input and prints the extracted text content from each page, truncated to 1000 characters.

**Inputs/Outputs:**

* **Input:** `pdf_path` (string): Path to the PDF file.
* **Output:** Prints extracted text content to the console.

**Side Effects:** Prints debugging information to the console.

**Dependencies:**

* `ocr.ocr_handler`:  Provides the `extract_text_from_pdf` function, which likely uses `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, and `requests` for PDF parsing and OCR. 





### üìÑ `main.py`
## main.py - Invoice Extraction Pipeline

This script automates invoice data extraction from PDF documents. 

**Purpose:**

* Process PDF invoices and extract key fields (e.g., invoice number, date, amount, vendor).
* Structure extracted data for easy access and analysis.
* Save extracted data to a JSON file.

**Key Functions:**

* `main(pdf_path)`:  Controls the entire extraction process.
* `extract_text_from_pdf(pdf_path)`: Performs OCR on the input PDF using the `ocr_handler` module.
* `generate_invoice_fields(cleaned_text)`:  Utilizes the Ollama LLM (`ollama_parser` module) to identify and extract invoice fields from preprocessed text.
* `clean_ocr_text(text)`: Prepares raw OCR output for LLM processing using the `text_cleaner` module.

**Inputs/Outputs:**

* **Input:** Path to a PDF file (`pdf_path`).
* **Output:**
    * Prints extracted invoice fields to the console.
    * Saves extracted data (raw LLM response and structured fields) as JSON in the "output" directory (filename: `<original_pdf_name>_extracted.json`).

**Dependencies:**

* **Python Libraries:** PIL, fitz, llm, ocr, pytesseract, requests
* **System:**
    * Locally installed Ollama LLM (see project instructions)
    * Tesseract OCR (installed via package manager, e.g., `sudo apt-get install tesseract-ocr`) 






### üìÑ `llm/ollama_parser.py`
## llm/ollama_parser.py Summary

This file provides a function to extract structured data from invoice text using an Ollama-based LLM.

**Purpose:**

-  Parse invoice text and identify key fields like invoice ID, dates, amounts, addresses, and line items.

**Key Functions/Classes:**

- `generate_invoice_fields(text)`: Processes invoice text and returns a dictionary of extracted fields in JSON format, along with the raw LLM output.

**Inputs/Outputs:**

- **Input:** `text` (string): Invoice text to be parsed.
- **Output:**
    - `json_data` (dict): Dictionary containing extracted invoice fields in JSON format.
    - `raw_output` (string): Raw output from the LLM, including potential error messages.

**Side Effects:**

- Sends a POST request to a local Ollama API endpoint (`http://localhost:11434/api/generate`) for processing.

**Dependencies:**

- **Python:** `requests`, `json`
- **System:** Ollama (installed locally from https://ollama.ai), Tesseract OCR (installed via `sudo apt-get install tesseract-ocr`) 


**Framework Patterns:**

- Employs a REST API for interaction with the Ollama LLM. 



### üìÑ `ocr/ocr_handler.py`
## ocr/ocr_handler.py

This file provides a function for extracting text from scanned PDF documents using OCR. 

**Key Function:**

- `extract_text_from_pdf(pdf_path)`: 
    - Takes the path to a PDF file as input.
    - Extracts text from each page using PyMuPDF to open the PDF, PIL to convert pages to images, and Tesseract OCR to recognize text within the images.
    - Returns a dictionary mapping page numbers to extracted text.

**Inputs/Outputs:**

- **Input:** `pdf_path` (string): Path to the input PDF file.
- **Output:** Dictionary: Keys are page numbers (e.g., "page_1"), values are the extracted text from each page.

**Dependencies:**

- `fitz` (PyMuPDF): For PDF manipulation.
- `PIL`: For image processing.
- `pytesseract`: For OCR using Tesseract. 





### üìÑ `utils/text_cleaner.py`
## utils/text_cleaner.py

This file provides utility functions for refining text extracted from OCR processes. 

**Purpose:** Enhance the accuracy and readability of OCR output by addressing common issues like extraneous whitespace, line breaks, hyphenation inconsistencies, non-ASCII characters, and OCR-specific errors.

**Key Functions:**

* `clean_ocr_text(text)`: 
    * **Input:** Raw text from an OCR engine.
    * **Output:** Cleaned and normalized text string.
    * **Behavior:**  Removes unnecessary whitespace and line breaks, corrects hyphenated words at line endings, eliminates non-ASCII characters, and applies fixes for prevalent OCR errors.

**Dependencies:**

* `re`: Python's regular expression library. 





