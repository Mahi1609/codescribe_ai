# üëã Welcome to c5d82823-8643-46f3-9616-4db72f8beeca

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama LLM (Large Language Model) to process PDF files. 
* The key components include:
  * `ocr_handler.py`: handles OCR extraction from PDFs
  * `ollama_parser.py`: generates invoice fields using the Ollama LLM
  * `text_cleaner.py`: preprocesses OCR-extracted text for LLM input
* The `main.py` script orchestrates the extraction process, taking a PDF file path as input, and produces a JSON output containing the extracted invoice fields and raw model response.
* Important dependencies include the Python standard library (`os`, `sys`, `json`) and custom modules (`ocr_handler`, `ollama_parser`, `text_cleaner`).
* The project's primary function is to extract structured invoice data from unstructured PDF documents, leveraging OCR and LLM technologies.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

#### main.py
**Purpose:** Extract invoice fields from a given PDF file.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the extraction process.
* `extract_text_from_pdf(pdf_path)`: Performs OCR extraction on the provided PDF file.
* `generate_invoice_fields(cleaned_text)`: Sends the preprocessed text to the local Ollama model to extract structured invoice fields.
* `clean_ocr_text(text)`: Preprocesses the extracted text to improve the accuracy of the LLM.

**Inputs:**
* `pdf_path`: The path to the PDF file from which to extract invoice fields.

**Outputs:**
* A JSON file containing the extracted invoice fields, saved to the "output" directory.
* Console output displaying the extracted fields and any relevant debugging information.

**Side-Effects:**
* Creates the "output" directory if it does not already exist.
* Saves the extracted invoice fields to a JSON file.

**Important Dependencies:**
* `ocr_handler.py`: Provides the `extract_text_from_pdf` function for OCR extraction.
* `ollama_parser.py`: Provides the `generate_invoice_fields` function for interacting with the local Ollama model.
* `text_cleaner.py`: Provides the `clean_ocr_text` function for preprocessing the extracted text.
* `json`: Used for saving the extracted invoice fields to a JSON file.
* `os`: Used for interacting with the file system and normalizing paths.
* `sys`: Used for accessing command-line arguments.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd c5d82823-8643-46f3-9616-4db72f8beeca
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd c5d82823-8643-46f3-9616-4db72f8beeca

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### Code File Summaries: debug_ocr.py

**Purpose:** 
The `debug_ocr.py` script extracts and displays text from a given PDF file using Optical Character Recognition (OCR) capabilities.

**Key Components:**
* The primary function `debug_ocr(pdf_path)` extracts text from a PDF file and prints it to the console.
* The `extract_text_from_pdf(pdf_path)` function from `ocr.ocr_handler` performs the actual OCR operation.

**Functionality:**
* The script takes a PDF file path as a command-line argument and prints the extracted text from each page, truncated to 1000 characters.
* It relies on external dependencies like Tesseract OCR and the `ocr.ocr_handler` module.

**Usage:**
To run this script, execute it from the command line with a PDF file path as an argument: `python debug_ocr.py /path/to/example.pdf` 

**Notes:**
* The script prints usage instructions if the required command-line argument is not provided.
* External dependencies, including Tesseract OCR, must be installed separately.


### üìÑ `main.py`
### Code File Summaries
#### main.py
**Purpose:** 
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

**Key Components:**
* Orchestrates invoice extraction using OCR and LLM
* Utilizes `extract_text_from_pdf`, `generate_invoice_fields`, and `clean_ocr_text` functions

**Functionality:**
* Takes a PDF file path as input
* Extracts text from the PDF using OCR
* Sends the extracted text to the Ollama model for structured invoice field generation
* Saves the raw model output and structured fields to a JSON file in the "output" directory

**Important Dependencies:**
* Python libraries: `PIL`, `fitz`, `llm`, `ocr`, `pytesseract`, `requests`
* External dependencies: `Ollama` AI model, `Tesseract OCR`

**Usage:**
Run the script with a PDF file path as a command-line argument: `python main.py <path_to_pdf>`


### üìÑ `llm/ollama_parser.py`
### Code File Summaries: `llm/ollama_parser.py`

The `ollama_parser.py` file contains a function to extract structured information from invoice text using a local LLM (Large Language Model) API.

**Key Components:**
* **Purpose:** Extract invoice fields from text using a local LLM API.
* **Key Function:** `generate_invoice_fields(text)` - extracts relevant fields from invoice text.
* **Inputs/Outputs:**
  + Input: `text` (invoice text to be parsed)
  + Outputs: 
    - `json_data`: A dictionary containing extracted invoice fields (e.g., invoice ID, date, total amount, line items)
    - `raw_output`: The raw response from the LLM API (parsed JSON data or an error message)
* **Side-Effects:**
  + Sends a POST request to the local LLM API at `http://localhost:11434/api/generate`
  + Returns a default dictionary with empty strings for all fields if the API request fails
* **Important Dependencies:**
  + `requests` library for sending HTTP requests to the LLM API
  + Local LLM API (Mistral model) running on `http://localhost:11434`
  + Ollama installation from `https://ollama.ai` and Tesseract OCR installation (e.g., `sudo apt-get install tesseract-ocr`)

**Behavior and Intent:**
The `generate_invoice_fields` function instructs the local LLM API to extract specific fields from the input invoice text and returns the extracted data in JSON format. If the API request or JSON parsing fails, it returns a default dictionary with empty strings for all fields.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py

**Purpose:** 
Extracts text from scanned PDFs using Optical Character Recognition (OCR).

**Key Components:**

* `extract_text_from_pdf(pdf_path)`: Extracts text from each page of a scanned PDF.
 
**Functionality:**

* Takes a PDF file path as input and returns a dictionary with page numbers as keys and extracted text as values.
* Utilizes `fitz` for PDF handling, `pytesseract` for OCR, and `PIL` for image processing.
* Requires Tesseract OCR to be installed on the system.

**Behavior:**

* Opens and closes the PDF document using `fitz`.
* Converts each page to a high-DPI image for improved OCR accuracy.
* Extracts text from each page image using `pytesseract`.
* Stores extracted text in a dictionary with page numbers as keys.

**Important Considerations:**

* Raises a `FileNotFoundError` if the specified PDF file does not exist.
* Accuracy of extracted text depends on the quality of the scanned PDF and Tesseract OCR configuration.


### üìÑ `utils/text_cleaner.py`
### `utils/text_cleaner.py`
#### Purpose
The `text_cleaner.py` module cleans and normalizes text extracted from Optical Character Recognition (OCR) processes.

#### Key Components
* `clean_ocr_text(text)`: Cleans raw OCR text by applying rules to remove extra whitespaces, fix broken words, normalize punctuation, and replace misread characters.

#### Inputs and Outputs
* Input: `text` (string) - Raw OCR text
* Output: `text` (string) - Cleaned and normalized text

#### Dependencies and Behavior
Utilizes Python's built-in `re` module for text pattern matching and replacement. The function efficiently addresses common OCR issues, resulting in cleaner and more accurate text output. It is designed to be extensible for handling additional OCR issues.

