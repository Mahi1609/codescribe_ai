# üëã Welcome to 92408f32-c24d-4a54-9d56-09ed881780e8

üìÑ *This documentation was automatically generated by [CodeScribe AI](https://github.com/Mahi1609/codescribe_ai.git)*

---

## üß† Overview
### Code File Summaries

The project is designed to extract invoice fields from PDF files using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM). The `main.py` file serves as the entry point, orchestrating the extraction process through the following key steps:
* OCR extraction of text from PDF files using the `extract_text_from_pdf` function from `ocr.ocr_handler`
* Text preprocessing using the `clean_ocr_text` function from `utils.text_cleaner`
* Sending the cleaned text to the Ollama model for invoice field extraction using the `generate_invoice_fields` function from `llm.ollama_parser`
* Saving the extracted invoice fields to a JSON file. 
The project relies on a modular structure, with separate modules for OCR handling, LLM interaction, and utility functions, to achieve its purpose.

---

## üîç What Does This Project Do?
This project is designed to ### Code File Summaries

#### PROJECT_PURPOSE
This project is a Python-based invoice extraction tool utilizing Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM) to extract structured invoice fields from PDF files.

#### main.py
**Purpose:** Extract invoice fields from PDF files using OCR and Ollama LLM.
**Key Functions:**
* `main(pdf_path)`: The primary entry point for the script, responsible for orchestrating the extraction process.
* `extract_text_from_pdf(pdf_path)`: Extracts text from a PDF file using OCR (imported from `ocr.ocr_handler`).
* `generate_invoice_fields(cleaned_text)`: Sends the preprocessed text to the Ollama model to extract structured invoice fields (imported from `llm.ollama_parser`).
* `clean_ocr_text(text)`: Preprocesses the extracted text before sending it to the Ollama model (imported from `utils.text_cleaner`).
**Inputs:**
* `pdf_path`: The path to the PDF file to extract invoice fields from.
**Outputs:**
* A JSON file containing the extracted invoice fields, saved to the `output` directory.
**Side-Effects:**
* Creates the `output` directory if it does not exist.
* Prints various debug messages and previews of the extraction process to the console.
**Important Dependencies:**
* `ocr.ocr_handler` for OCR text extraction
* `llm.ollama_parser` for Ollama LLM integration
* `utils.text_cleaner` for text preprocessing

Note: The code uses a command-line argument to pass the PDF file path to the `main` function. If no argument is provided, it prints usage instructions.

---

## üõ† Tech Stack Used
- **Detected Environment:** `python`
- **Languages & Frameworks:**


  - Python

  - Node

  - System



---

## üì¶ Dependencies


### Python


- PIL

- fitz

- llm

- ocr

- pytesseract

- requests



### Node

- No dependencies detected


### System


- Install Ollama from https://ollama.ai (required for running local LLMs).

- Install Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`).







---

## ‚öôÔ∏è Installation & Run
To get started with this project:

### Clone the repository
```bash
git clone <your-repo-url>
cd 92408f32-c24d-4a54-9d56-09ed881780e8
```

### (Optional) Create a virtual environment
```bash
python -m venv venv
source venv/bin/activate   # On Windows: venv\Scripts\activate
```

### Install dependencies

```bash
pip install -r requirements.txt
```


### How to run
```bash
## Clone the repository
git clone <your-repo-url>
cd 92408f32-c24d-4a54-9d56-09ed881780e8

## Install dependencies
pip install -r requirements.txt

## Run the app
python main.py
```

---

## üß© Code File Summaries

### üìÑ `debug_ocr.py`
### Code File Summaries: debug_ocr.py

**Purpose:** 
The `debug_ocr.py` script extracts and displays text from a given PDF file using Optical Character Recognition (OCR) for debugging purposes.

**Key Components:**

* The script utilizes the `extract_text_from_pdf` function from the `ocr.ocr_handler` module to perform OCR operations.
* The main function, `debug_ocr`, takes a PDF file path as input, extracts text from each page, and prints it to the console (truncated to 1000 characters per page).

**Inputs and Outputs:**

* Input: A PDF file path is expected as a command-line argument.
* Output: Extracted text from each PDF page is printed to the console.

**Side-Effects and Dependencies:**

* The script relies on the `ocr.ocr_handler` module and indirectly on OCR libraries like Tesseract OCR, which must be installed separately.
* If the required command-line argument is not provided, the script prints usage instructions.

**Running the Script:**

To execute `debug_ocr.py`, provide a PDF file path as a command-line argument:
```bash
python debug_ocr.py /path/to/example.pdf
```
Ensure that Tesseract OCR and other required dependencies are installed and configured properly.


### üìÑ `main.py`
### Code File Summaries: main.py
#### Purpose
The `main.py` script extracts invoice fields from a given PDF file using Optical Character Recognition (OCR) and a local Ollama Large Language Model (LLM).

#### Key Components
* Orchestrates invoice extraction using OCR and LLM
* Utilizes `extract_text_from_pdf`, `generate_invoice_fields`, and `clean_ocr_text` functions from respective modules

#### Functionality
* Takes a PDF file path as input, extracts text using OCR, and sends it to the Ollama model for structured invoice field generation
* Outputs structured invoice fields and a JSON file containing raw Ollama model output and invoice fields

#### Important Details
* Creates an `output` directory if it does not exist and saves extracted invoice fields to a JSON file within
* Depends on `PIL`, `fitz`, `llm`, `ollama`, `ocr`, `pytesseract`, and system-installed `Tesseract OCR` and `Ollama`

#### Usage
Run the script using `python main.py <path_to_pdf>`, replacing `<path_to_pdf>` with the desired PDF file path.


### üìÑ `llm/ollama_parser.py`
### Code File Summaries: `llm/ollama_parser.py`

The `ollama_parser.py` file provides a function to parse invoice text and extract structured information using a local Large Language Model (LLM) API.

**Key Features:**
* Purpose: Extract invoice fields from text using a local LLM API
* Key Function: `generate_invoice_fields(text)` 
* Inputs: 
  + `text` (string): Invoice text to be parsed
* Outputs: 
  + `json_data` (dict): Extracted invoice fields in JSON format
  + `raw_output` (string): Raw output from the LLM API or an error message
* Side-Effects: 
  + Sends a POST request to the local LLM API at `http://localhost:11434/api/generate`
  + Returns a default empty JSON object if the API request fails
* Important Dependencies: 
  + `requests` library for HTTP requests
  + Local LLM API (e.g., Ollama) running on `http://localhost:11434`

The `generate_invoice_fields` function constructs a prompt with the invoice text, sends it to the LLM API, and returns the extracted fields in JSON format. If the API request fails, it returns a default empty JSON object. The extracted fields include invoice ID, number, date, due date, total amount, tax amount, supplier name, and line items.


### üìÑ `ocr/ocr_handler.py`
### ocr_handler.py

**Purpose:** 
Extracts text from scanned PDFs using Optical Character Recognition (OCR).

**Key Components:**

* `extract_text_from_pdf(pdf_path)`: Extracts text from each page of a scanned PDF.
 
**Functionality:**

* Takes a PDF file path as input and returns a dictionary with page numbers as keys and extracted text as values.
* Utilizes `fitz` for PDF handling, `pytesseract` for OCR, and `PIL` for image processing.
* Requires Tesseract OCR installation and may depend on the quality of the scanned PDF for accurate results.

**Important Considerations:**

* Raises a `FileNotFoundError` if the specified PDF file does not exist.
* Relies on system-installed Tesseract OCR (e.g., `sudo apt-get install tesseract-ocr`) for text extraction.


### üìÑ `utils/text_cleaner.py`
### Code File Summaries

#### `utils/text_cleaner.py`
**Purpose:** Clean and normalize text extracted from Optical Character Recognition (OCR) processes.

**Key Components:**
* `clean_ocr_text(text)`: Cleans and normalizes the input text.

**Behavior:**
* Removes extra whitespaces and line breaks
* Fixes broken words with hyphenations at line ends
* Normalizes punctuation and special characters
* Replaces common misread characters and words

**Dependencies:**
* `re` (Python's built-in regular expression module)
* Intended for use with OCR libraries like `pytesseract` and `fitz`

**Inputs/Outputs:**
* Input: Raw OCR-extracted text (string)
* Output: Cleaned and normalized text (string)

**Notes:**
No side-effects. Designed to improve text extraction accuracy from images and documents.

